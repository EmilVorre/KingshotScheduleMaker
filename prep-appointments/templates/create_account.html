<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Account - Schedule Maker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        body { 
            font-family: 'Inter', sans-serif;
            background-color: #1a1a1a;
        }
    </style>
</head>
<body class="min-h-screen bg-gray-900 text-white">
    <div id="app">
        <div class="container mx-auto px-4 py-8 max-w-4xl">
            <header class="text-center mb-12">
                <h1 class="text-4xl font-bold text-blue-400 mb-4">
                    <i class="fas fa-user-plus mr-3"></i>Create Account
                </h1>
                <p class="text-gray-400">Create a new account to manage your server schedule</p>
            </header>
            
            <div class="bg-gray-800 rounded-lg shadow-xl p-8 border border-gray-700">
                <transition name="fade">
                    <div v-if="!accountCreated">
                        <form @submit.prevent="handleCreateAccount" class="space-y-6">
                            <div>
                                <label for="account_name" class="block text-sm font-semibold text-gray-300 mb-2">
                                    <i class="fas fa-user mr-2"></i>Account Name
                                </label>
                                <input 
                                    type="text" 
                                    id="account_name" 
                                    v-model="form.account_name"
                                    required
                                    class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:ring-2 focus:ring-blue-500/50 outline-none transition-all"
                                    placeholder="Enter account name">
                                <p class="text-xs text-gray-500 mt-1">Used in your schedule URL</p>
                            </div>
                            
                            <div>
                                <label for="server_number" class="block text-sm font-semibold text-gray-300 mb-2">
                                    <i class="fas fa-server mr-2"></i>Server Number
                                </label>
                                <input 
                                    type="number" 
                                    id="server_number" 
                                    v-model.number="form.server_number"
                                    required
                                    min="1"
                                    class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:ring-2 focus:ring-blue-500/50 outline-none transition-all"
                                    placeholder="Enter server number">
                            </div>
                            
                            <div>
                                <label for="in_game_name" class="block text-sm font-semibold text-gray-300 mb-2">
                                    <i class="fas fa-gamepad mr-2"></i>In-Game Name
                                </label>
                                <input 
                                    type="text" 
                                    id="in_game_name" 
                                    v-model="form.in_game_name"
                                    required
                                    class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:ring-2 focus:ring-blue-500/50 outline-none transition-all"
                                    placeholder="Enter your in-game name">
                            </div>
                            
                            <div>
                                <label for="password" class="block text-sm font-semibold text-gray-300 mb-2">
                                    <i class="fas fa-lock mr-2"></i>Password
                                </label>
                                <input 
                                    type="password" 
                                    id="password" 
                                    v-model="form.password"
                                    required
                                    class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:ring-2 focus:ring-blue-500/50 outline-none transition-all"
                                    placeholder="Enter password">
                                <p class="text-xs text-gray-500 mt-1">Password is used for authentication and CSV uploads. Schedules are publicly viewable.</p>
                            </div>
                            
                            <button 
                                type="submit" 
                                :disabled="creating"
                                class="w-full bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold transition-all shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed">
                                <i v-if="!creating" class="fas fa-plus-circle mr-2"></i>
                                <i v-else class="fas fa-spinner fa-spin mr-2"></i>
                                {{ creating ? 'Creating Account...' : 'Create Account' }}
                            </button>
                        </form>
                        
                        <transition name="fade">
                            <div v-if="error" class="mt-4 p-4 bg-red-900/50 border-l-4 border-red-500 text-red-200 rounded">
                                <i class="fas fa-exclamation-circle mr-2"></i>{{ error }}
                            </div>
                        </transition>
                    </div>
                    
                    <div v-else class="text-center">
                        <div class="mb-6">
                            <div class="inline-block bg-green-900/50 rounded-full p-4 mb-4">
                                <i class="fas fa-check-circle text-green-400 text-4xl"></i>
                            </div>
                            <h2 class="text-2xl font-bold text-green-400 mb-2">Account Created Successfully!</h2>
                            <p class="text-gray-400 mb-6">Your schedule URL is ready</p>
                        </div>
                        
                        <div class="bg-gray-700 rounded-lg p-4 mb-6">
                            <p class="text-sm text-gray-400 mb-2">Your Schedule URL:</p>
                            <code class="text-blue-400 font-mono text-lg break-all">{{ scheduleUrl }}</code>
                        </div>
                        
                        <div class="flex gap-4 justify-center">
                            <a :href="scheduleUrl" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold transition-all shadow-lg hover:shadow-xl">
                                <i class="fas fa-calendar-check mr-2"></i>View Schedule
                            </a>
                            <a :href="dashboardUrl" class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-semibold transition-all shadow-lg hover:shadow-xl">
                                <i class="fas fa-sign-in-alt mr-2"></i>Login
                            </a>
                        </div>
                    </div>
                </transition>
            </div>
            
            <div class="text-center mt-8">
                <a href="/" class="text-blue-400 hover:text-blue-300 transition-colors">
                    <i class="fas fa-arrow-left mr-2"></i>Back to Home
                </a>
            </div>
        </div>
    </div>
    
    <style>
        .fade-enter-active, .fade-leave-active {
            transition: opacity 0.3s;
        }
        .fade-enter-from, .fade-leave-to {
            opacity: 0;
        }
    </style>
    
    <script>
        const { createApp } = Vue;
        
        createApp({
            data() {
                return {
                    creating: false,
                    error: null,
                    accountCreated: false,
                    scheduleUrl: '',
                    dashboardUrl: '',
                    form: {
                        account_name: '',
                        server_number: null,
                        password: '',
                        in_game_name: ''
                    }
                }
            },
            methods: {
                async handleCreateAccount() {
                    this.creating = true;
                    this.error = null;
                    
                    try {
                        const response = await fetch('/api/create-account', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(this.form)
                        });
                        
                        const data = await response.json();
                        
                        if (data.success) {
                            this.scheduleUrl = data.schedule_url || `/${this.form.account_name}/${this.form.server_number}`;
                            this.dashboardUrl = `/dashboard/${this.form.account_name}`;
                            this.accountCreated = true;
                        } else {
                            this.error = data.message || 'Failed to create account';
                        }
                    } catch (err) {
                        this.error = 'Error: ' + err.message;
                    } finally {
                        this.creating = false;
                    }
                }
            }
        }).mount('#app');
    </script>
</body>
</html>
